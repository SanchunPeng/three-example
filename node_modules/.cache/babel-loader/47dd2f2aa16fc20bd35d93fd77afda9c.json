{"ast":null,"code":"var _jsxFileName = \"/Users/a58/dev/car-test/src/components/DisplayCar.js\";\nimport React, { Component } from 'react';\nimport createRender from '../utils/createRender';\nimport objcontrol from '../controls/objcontrol';\nconst THREE = window.THREE;\nexport default class DisplayCar extends Component {\n  constructor(props) {\n    super(props);\n\n    this.changeCarMaterial = color => {\n      this.scene.children.forEach(item => {\n        if (item.name === 'car') {\n          console.log(item);\n          item.children[0].material.color = new THREE.Color('rgb(255, 0,0');\n        }\n      });\n    };\n\n    this.createCarObj = () => {\n      const _this = this;\n\n      const loader = new THREE.OBJLoader2(null, {\n        enabled: false,\n        debug: false\n      });\n\n      const objLoadedBack = function (obj) {\n        // console.log(obj.detail.loaderRootNode.children[0])\n        const object = obj.detail.loaderRootNode;\n        object.name = 'car';\n\n        _this.scene.add(object);\n      };\n\n      const mtlLoadedBack = function (materials) {\n        // loader.setModelName('car');\n        loader.setMaterials(materials); // loader.setLogging( true, true );\n        // 开始加载 obj\n\n        loader.load(require('../objs/car1/file.obj'), objLoadedBack, null, null, null, false);\n      };\n\n      loader.loadMtl(require('../objs/car1/file.mtl'), null, mtlLoadedBack);\n    };\n\n    this.createCarObj2 = () => {\n      const _this = this;\n\n      const loader = new THREE.OBJLoader2(null, {\n        enabled: false,\n        debug: false\n      });\n\n      const objLoadedBack = function (obj) {\n        console.log(obj.detail.loaderRootNode.children[0].material.color);\n        obj.detail.loaderRootNode.children[0].material.color = new THREE.Color(0xff0000);\n\n        _this.scene.add(obj.detail.loaderRootNode);\n      };\n\n      loader.setModelName('car');\n      loader.load(require('../objs/car1/file.obj'), objLoadedBack, null, null, null, false);\n    };\n\n    this.initScene = () => {\n      const _this = this;\n\n      const _this$nextProps = this.nextProps,\n            fullWidth = _this$nextProps.fullWidth,\n            fullHeight = _this$nextProps.fullHeight;\n      const container = this.container = document.getElementById('car-show');\n      const renderer = this.renderer = createRender({\n        fullWidth,\n        fullHeight\n      });\n      const scene = this.scene = new THREE.Scene();\n      const camera = this.camera = this.createCamera(fullWidth, fullHeight);\n      this.scene.add(camera);\n      container.appendChild(this.renderer.domElement); // 添加环境光与平行光\n\n      const ambientLight = new THREE.AmbientLight(0x404040);\n      const directionalLight1 = new THREE.DirectionalLight(0xC0C090);\n      const directionalLight2 = new THREE.DirectionalLight(0xC0C090);\n      directionalLight1.position.set(-100, -50, 100);\n      directionalLight2.position.set(100, 50, -100);\n      this.scene.add(directionalLight1);\n      this.scene.add(directionalLight2);\n      this.scene.add(ambientLight); // 添加调试网格\n\n      const helper = new THREE.GridHelper(1200, 60, 0xFF4444, 0x404040);\n      this.scene.add(helper);\n      animation();\n\n      function animation() {\n        requestAnimationFrame(animation);\n        renderer.render(scene, camera);\n\n        _this.controls.update();\n      }\n\n      this.createCarObj();\n    };\n\n    this.createCamera = (width, height) => {\n      const camera = new THREE.PerspectiveCamera(50, 1, 0.5, 100000);\n      camera.name = 'camera';\n      camera.width = width;\n      camera.height = height;\n      camera.aspect = width / height;\n      camera.lookAt(new THREE.Vector3(0, 0, 0));\n      camera.position.set(0.0, 175.0, 500.0);\n      camera.updateProjectionMatrix();\n      this.controls = objcontrol(camera, this.renderer.domElement);\n      return camera;\n    };\n\n    this.state = {};\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.nextProps = nextProps;\n\n    if (nextProps.fullWidth !== this.props.fullWidth) {\n      this.initScene();\n    }\n\n    if (nextProps.currentColor !== this.props.currentColor && nextProps.currentColor !== '') {\n      this.changeCarMaterial(nextProps.currentColor);\n    }\n  }\n\n  componentDidMount() {\n    window.displaycars = this;\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      id: \"car-show\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    });\n  }\n\n}","map":{"version":3,"sources":["/Users/a58/dev/car-test/src/components/DisplayCar.js"],"names":["React","Component","createRender","objcontrol","THREE","window","DisplayCar","constructor","props","changeCarMaterial","color","scene","children","forEach","item","name","console","log","material","Color","createCarObj","_this","loader","OBJLoader2","enabled","debug","objLoadedBack","obj","object","detail","loaderRootNode","add","mtlLoadedBack","materials","setMaterials","load","require","loadMtl","createCarObj2","setModelName","initScene","nextProps","fullWidth","fullHeight","container","document","getElementById","renderer","Scene","camera","createCamera","appendChild","domElement","ambientLight","AmbientLight","directionalLight1","DirectionalLight","directionalLight2","position","set","helper","GridHelper","animation","requestAnimationFrame","render","controls","update","width","height","PerspectiveCamera","aspect","lookAt","Vector3","updateProjectionMatrix","state","componentWillReceiveProps","currentColor","componentDidMount","displaycars"],"mappings":"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","sourcesContent":["import React, {Component} from 'react'\nimport createRender from '../utils/createRender'\nimport objcontrol from '../controls/objcontrol';\nconst THREE = window.THREE\n\n\nexport default class DisplayCar extends Component{\n    scene\n    container\n    camera\n    renderer\n    controls\n    constructor(props) {\n       super(props);\n       this.state = {\n\n       }\n    }\n\n    componentWillReceiveProps(nextProps) {\n        this.nextProps = nextProps\n\n        if (nextProps.fullWidth !== this.props.fullWidth) {\n            this.initScene()\n        }\n        if (nextProps.currentColor !== this.props.currentColor && nextProps.currentColor !== '') {\n            this.changeCarMaterial(nextProps.currentColor)\n        }\n    }\n\n    changeCarMaterial = (color) => {\n        this.scene.children.forEach(item => {\n            if (item.name === 'car') {\n                console.log(item)\n                item.children[0].material.color = new THREE.Color('rgb(255, 0,0')\n            }\n        })\n    }\n\n\n    createCarObj = () => {\n        const _this = this\n\n        const loader = new THREE.OBJLoader2(null, {enabled: false, debug: false})\n        const objLoadedBack = function (obj) {\n            // console.log(obj.detail.loaderRootNode.children[0])\n            const object = obj.detail.loaderRootNode\n            object.name = 'car'\n            _this.scene.add( object );\n        }\n        const mtlLoadedBack = function (materials) {\n            // loader.setModelName('car');\n            loader.setMaterials( materials );\n            // loader.setLogging( true, true );\n            // 开始加载 obj\n            loader.load( require('../objs/car1/file.obj'), objLoadedBack, null, null, null, false );\n        }\n        loader.loadMtl( require('../objs/car1/file.mtl'), null, mtlLoadedBack );\n    }\n\n    createCarObj2 = () => {\n        const _this = this\n\n        const loader = new THREE.OBJLoader2(null, {enabled: false, debug: false})\n        const objLoadedBack = function (obj) {\n            console.log(obj.detail.loaderRootNode.children[0].material.color)\n            obj.detail.loaderRootNode.children[0].material.color =  new THREE.Color( 0xff0000 )\n            _this.scene.add( obj.detail.loaderRootNode );\n        }\n        loader.setModelName('car');\n        loader.load( require('../objs/car1/file.obj'), objLoadedBack, null, null, null, false );\n\n    }\n\n    initScene = () => {\n        const _this = this\n        const {fullWidth, fullHeight} = this.nextProps\n        const container = this.container = document.getElementById('car-show')\n        const renderer = this.renderer = createRender({fullWidth, fullHeight})\n        const scene = this.scene = new THREE.Scene()\n        const camera = this.camera = this.createCamera(fullWidth, fullHeight)\n        this.scene.add(camera)\n        container.appendChild(this.renderer.domElement)\n\n        // 添加环境光与平行光\n        const ambientLight = new THREE.AmbientLight( 0x404040 );\n        const directionalLight1 = new THREE.DirectionalLight( 0xC0C090 );\n        const directionalLight2 = new THREE.DirectionalLight( 0xC0C090 );\n\n        directionalLight1.position.set( -100, -50, 100 );\n        directionalLight2.position.set( 100, 50, -100 );\n\n        this.scene.add( directionalLight1 );\n        this.scene.add( directionalLight2 );\n        this.scene.add( ambientLight );\n        // 添加调试网格\n        const helper = new THREE.GridHelper( 1200, 60, 0xFF4444, 0x404040 );\n        this.scene.add( helper );\n\n        animation()\n        function animation () {\n            requestAnimationFrame(animation)\n            renderer.render(scene, camera)\n            _this.controls.update();\n        }\n\n        this.createCarObj()\n\n    }\n\n    createCamera = (width, height) => {\n        const camera = new THREE.PerspectiveCamera( 50, 1, 0.5, 100000 )\n        camera.name = 'camera'\n        camera.width = width\n        camera.height = height\n        camera.aspect = width/height\n        camera.lookAt(new THREE.Vector3(0, 0, 0))\n        camera.position.set(0.0, 175.0, 500.0)\n        camera.updateProjectionMatrix();\n        this.controls = objcontrol(camera, this.renderer.domElement)\n        return camera\n    }\n\n    componentDidMount() {\n        window.displaycars = this\n\n    }\n\n    render() {\n        return <div id=\"car-show\">\n        </div>\n    }\n\n}"]},"metadata":{},"sourceType":"module"}